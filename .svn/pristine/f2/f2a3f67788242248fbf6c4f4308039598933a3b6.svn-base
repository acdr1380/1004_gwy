<div class="layout" [class.full_screen]="isFullScreen">
    <div class="container">
        <div class="left self_left">
            <!-- <div class="find">
                    <div class="left_btn">
                        <button
                            nz-button
                            nzType="primary"
                            style="margin-right: 20px"
                            (click)="personSelectIfy.evtSysOutAddPsn()"
                            [disabled]="!isUsable"
                        >
                            系统外添加人员
                        </button>
                        <button
                            nz-button
                            nzType="primary"
                            (click)="personSelectIfy.evtSelectPerson()"
                            [disabled]="!isUsable"
                        >
                            系统内添加人员
                        </button>
                    </div>
                </div> -->
            <div class="find left_btn">
                <div [style.width.px]="canEdit ? '140' : '200'">
                    <nz-select
                        nzShowSearch
                        nzServerSearch
                        nzAllowClear
                        [nzPlaceHolder]="personListIfy.find.placeholder || '请输入关键字搜索'"
                        [nzShowArrow]="false"
                        [nzFilterOption]="personListIfy.find.nzFilterOption"
                        [(ngModel)]="personListIfy.find.value"
                        (ngModelChange)="personListIfy.find.evtChange($event)"
                        (nzOnSearch)="personListIfy.find.evtSearch($event)"
                        (nzOpenChange)="personListIfy.find.evtOpenChange($event)"
                    >
                        <ng-container>
                            <nz-option
                                *ngFor="let item of personListIfy.find.list"
                                [nzLabel]="item.name"
                                [nzValue]="item.keyId"
                            >
                            </nz-option>
                        </ng-container>
                    </nz-select>
                </div>

                <div [hidden]="!canEdit" class="out_inner_icon">
                    <i
                        class="opreate_icon"
                        nz-icon
                        [nzType]="'border-outer'"
                        nz-tooltip
                        nzTooltipTitle="系统外添加人员"
                        (click)="personSelectIfy.evtSysOutAddPsn()"
                    ></i>
                </div>
                <div [hidden]="!canEdit" class="out_inner_icon">
                    <i
                        class="opreate_icon"
                        nz-icon
                        [nzType]="'border-inner'"
                        nz-tooltip
                        nzTooltipTitle="系统内添加人员"
                        (click)="personSelectIfy.evtSelectPerson()"
                    ></i>
                </div>
            </div>
            <div class="tree">
                <cdk-virtual-scroll-viewport
                    #scrollViewPersonList
                    [itemSize]="40"
                    class="view_scroll audit_list"
                >
                    <ng-container *ngFor="let item of personListIfy.pagePsnList; let i = index">
                        <div
                            class="item"
                            [class.active]="item === personListIfy.selectedPsnData"
                            (click)="personListIfy.evtSelectedPerson(item)"
                        >
                            <div class="title">
                                {{
                                    (personListIfy.pageIndex - 1) * personListIfy.pageSize +
                                        (i + 1) +
                                        '.'
                                }}
                                {{ item.name }}
                            </div>
                            <div class="btns" *ngIf="canEdit && jobStepInfo.stepId === 'start'">
                                <div
                                    class="btn danger"
                                    (click)="personListIfy.evtDeletePerson(item)"
                                >
                                    <!-- 撤选 -->
                                    <i
                                        class="special_icon opreate_icon"
                                        nz-icon
                                        [nzType]="'minus-square'"
                                        nz-tooltip
                                        nzTooltipTitle="撤选"
                                    ></i>
                                </div>
                            </div>
                        </div>
                    </ng-container>
                </cdk-virtual-scroll-viewport>
            </div>

            <div class="find bottom">
                <nz-pagination
                    nzSimple
                    nzHideOnSinglePage
                    [(nzPageIndex)]="personListIfy.pageIndex"
                    [nzTotal]="personListIfy.list.length"
                    [(nzPageSize)]="personListIfy.pageSize"
                    (nzPageIndexChange)="personListIfy.pageChange()"
                ></nz-pagination>
            </div>
        </div>

        <div class="right">
            <div class="spin" *ngIf="personListIfy.selectedPsnData || sysOuterStatus">
                <ng-template [ngTemplateOutlet]="personBaseInfoTemp"></ng-template>
                <!-- 分隔符 -->
                <div class="view_mid"></div>
                <ng-template [ngTemplateOutlet]="otherInfoTemplate"></ng-template>
            </div>

            <div class="empty" *ngIf="!personListIfy.selectedPsnData || !sysOuterStatus">
                <div>
                    <nz-result [nzIcon]="img" nzTitle="点击左侧添加人员按钮添加人员"> </nz-result>
                    <ng-template #img>
                        <i><img src="assets/images/wf/selectPerson.png" /></i>
                    </ng-template>
                </div>
            </div>
        </div>
    </div>
</div>

<oper-select-person
    #operSelectPerson
    [isSelectUnit]="true"
    [jobStepInfo]="jobStepInfo"
    [filterParmas]="personSelectIfy.filterParmas"
    (selectedChange)="personSelectIfy.evtSysInnerChange($event)"
    [disabledList]="personSelectIfy.psnDataChange()"
>
</oper-select-person>

<!-- 人员基本情况 -->
<ng-template #personBaseInfoTemp>
    <div [class.full_screen]="isUpFullScreen">
        <div class="layout">
            <div class="header tabset_header">
                <div>
                    <nz-tabset
                        nzType="card"
                        nzTabPosition="top"
                        [(nzSelectedIndex)]="psnBaseInfoIfy.currentTabIndex"
                        [nzSize]="'small'"
                        [nzTabBarStyle]="{
                            'margin.px': 0,
                            'height.px': 50,
                            'padding-top.px': 10
                        }"
                        (nzSelectedIndexChange)="psnBaseInfoIfy.evtTabChange()"
                    >
                        <nz-tab
                            *ngFor="let item of psnBaseInfoIfy.list"
                            [nzTitle]="item.TABLE_NAME"
                        ></nz-tab>
                    </nz-tabset>
                </div>
                <!-- <div class="right" [hidden]="psnBaseInfoIfy.TABLE_CODE === 'A01'">
                    <button *ngIf="psnBaseInfoIfy.TABLE_CODE !== 'A01'" nz-button nzType="primary" (click)="psnBaseInfoIfy.evtAddPsnData()">
                        增加
                    </button>
                </div> -->

                <!-- <div class="tabset_extra">
                    <div class="arrows" (click)="evtUpDownArrows('up')">
                        <i class="fa fa-arrows-alt"></i>
                    </div>
                </div> -->

                <div class="right">
                    <button
                        nz-button
                        nzType="link"
                        nz-tooltip
                        nzTooltipTitle="流程图"
                        (click)="wfInfoDrawer.show('step')"
                    >
                        <i nz-icon nzType="cluster"></i>
                    </button>
                    <button
                        nz-button
                        nzType="link"
                        nz-tooltip
                        nzTooltipTitle="流程跟踪"
                        (click)="wfInfoDrawer.show('opertail')"
                    >
                        <i nz-icon nzType="deployment-unit"></i>
                    </button>
                    <button
                        nz-button
                        nzType="link"
                        nz-tooltip
                        nzTooltipTitle="全屏"
                        (click)="fullScreenSwith()"
                    >
                        <i nz-icon nzType="fullscreen"></i>
                    </button>
                </div>
            </div>
            <div class="container">
                <ng-container *ngFor="let item of psnBaseInfoIfy.list">
                    <div
                        class="view_scroll"
                        [hidden]="
                            !(
                                item.TABLE_CODE ===
                                psnBaseInfoIfy.list[psnBaseInfoIfy.currentTabIndex].TABLE_CODE
                            )
                        "
                    >
                        <!-- 判断如果是主集或（子集，判断是津补贴和非津补贴业务） -->
                        <ng-template
                            [ngTemplateOutlet]="
                                item.IS_MAIN
                                    ? A01ChildTemp
                                    : item.IS_Allow
                                    ? AllowTable
                                    : item.IS_PSN_FILE
                                    ? personFileTemp
                                    : tableChildTemp
                            "
                            [ngTemplateOutletContext]="{
                                fields: item.fields,
                                result: item.PSN ? item.result : item.data
                            }"
                        ></ng-template>
                    </div>
                </ng-container>
            </div>
            <!-- 如果是津补贴不显示下面按钮 -->
            <div
                class="footer"
                [hidden]="
                    psnBaseInfoIfy.list[psnBaseInfoIfy.currentTabIndex]?.IS_Allow ||
                    psnBaseInfoIfy.list[psnBaseInfoIfy.currentTabIndex]?.IS_PSN_FILE
                "
            >
                <button
                    *ngIf="psnBaseInfoIfy.list[psnBaseInfoIfy.currentTabIndex].TABLE_CODE !== 'A01'"
                    nz-button
                    style="margin-right: 10px"
                    nzType="dashed"
                    (click)="psnBaseInfoIfy.evtAddPsnData()"
                    [disabled]="!canEdit"
                >
                    增加
                </button>
                <button
                    nz-button
                    nzType="default"
                    style="margin-right: 10px"
                    [nzLoading]="psnBaseInfoIfy.londing"
                    (click)="psnBaseInfoIfy.evtSaveChildData()"
                    [disabled]="!canEdit"
                >
                    保存
                </button>

                <button [disabled]="!canEdit" nz-button nzType="primary" (click)="checkSalary()">
                    核定工资
                </button>
            </div>
        </div>
    </div>
</ng-template>

<!-- A01 -->
<ng-template #A01ChildTemp let-TABLE_CODE="TABLE_CODE" let-fields="fields" let-result="result">
    <div class="view view_table">
        <table class="custom_table">
            <tbody>
                <ng-container *ngFor="let f of fields; let row = index">
                    <tr *ngIf="row % 3 === 0">
                        <ng-container *ngFor="let item of fields; let column = index">
                            <ng-container *ngIf="column >= row && column < row + 3">
                                <td class="label" [attr.columnName]="item.TABLE_COLUMN_CODE">
                                    {{ item.TABLE_COLUMN_NAME }}
                                </td>

                                <ng-container *ngIf="item.TABLE_COLUMN_CODE !== 'A0149'">
                                    <td
                                        class="value"
                                        [class.value_readly]="item.canEdit"
                                        [class.value_date]="item.TABLE_COLUMN_TYPE === 4"
                                    >
                                        <ng-container
                                            *ngIf="
                                                item.TABLE_COLUMN_DICTIONARY_CODE;
                                                else elseGeneralTemplate
                                            "
                                        >
                                            <ng-container *ngIf="item.canEdit; else editInputTemp">
                                                {{ result[item.TABLE_COLUMN_CODE + '_CN'] }}
                                            </ng-container>
                                            <ng-template #editInputTemp>
                                                <input
                                                    [readOnly]="item.TABLE_COLUMN_DICTIONARY_CODE"
                                                    [ngModel]="
                                                        result[item.TABLE_COLUMN_CODE + '_CN']
                                                    "
                                                    (click)="
                                                        psnBaseInfoIfy.evtClick(
                                                            $event,
                                                            item,
                                                            result
                                                        )
                                                    "
                                                />
                                            </ng-template>
                                        </ng-container>
                                        <ng-template #elseGeneralTemplate>
                                            <ng-container *ngIf="item.canEdit; else unDicCodeTemp">
                                                <ng-container
                                                    *ngIf="item.TABLE_COLUMN_CODE !== 'A0157'"
                                                >
                                                    <ng-container
                                                        *ngIf="item.TABLE_COLUMN_CODE !== 'A0134B'"
                                                    >
                                                        {{ result[item.TABLE_COLUMN_CODE] }}
                                                    </ng-container>
                                                    <ng-container
                                                        *ngIf="item.TABLE_COLUMN_CODE === 'A0134B'"
                                                    >
                                                        {{ result[item.TABLE_COLUMN_CODE] }}
                                                        <div class="glIcon">
                                                            <i
                                                                nz-tooltip
                                                                nzTooltipTitle="工龄情况"
                                                                nz-icon
                                                                nzType="edit"
                                                                nzTheme="outline"
                                                                (click)="
                                                                    psnBaseInfoIfy.evtClick(
                                                                        $event,
                                                                        item,
                                                                        result
                                                                    )
                                                                "
                                                            ></i>
                                                        </div>
                                                    </ng-container>
                                                </ng-container>

                                                <ng-container
                                                    *ngIf="item.TABLE_COLUMN_CODE === 'A0157'"
                                                >
                                                    {{ result[item.TABLE_COLUMN_CODE + '_CN'] }}
                                                </ng-container>
                                            </ng-container>
                                            <ng-template #unDicCodeTemp>
                                                <ng-container
                                                    *ngIf="
                                                        item.TABLE_COLUMN_CODE === 'A0134A' ||
                                                        item.TABLE_COLUMN_CODE === 'A0134B'
                                                    "
                                                >
                                                    <input
                                                        [(ngModel)]="result[item.TABLE_COLUMN_CODE]"
                                                        (click)="
                                                            psnBaseInfoIfy.evtClick(
                                                                $event,
                                                                item,
                                                                result
                                                            )
                                                        "
                                                        (blur)="
                                                            psnBaseInfoIfy.evtBlur(
                                                                $event,
                                                                item,
                                                                result
                                                            )
                                                        "
                                                    />
                                                    <div class="glIcon">
                                                        <i
                                                            nz-tooltip
                                                            nzTooltipTitle="工龄情况"
                                                            nz-icon
                                                            nzType="edit"
                                                            nzTheme="outline"
                                                            (click)="
                                                                psnBaseInfoIfy.evtClick(
                                                                    $event,
                                                                    item,
                                                                    result
                                                                )
                                                            "
                                                            (blur)="
                                                                psnBaseInfoIfy.evtBlur(
                                                                    $event,
                                                                    item,
                                                                    result
                                                                )
                                                            "
                                                        ></i>
                                                    </div>
                                                </ng-container>

                                                <ng-container
                                                    *ngIf="
                                                        item.TABLE_COLUMN_CODE !== 'A0134A' &&
                                                        item.TABLE_COLUMN_CODE !== 'A0134B'
                                                    "
                                                >
                                                    <ng-container
                                                        [ngSwitch]="item.TABLE_COLUMN_TYPE"
                                                    >
                                                        <ng-template [ngSwitchCase]="4">
                                                            <datetime-input
                                                                nzMin="0"
                                                                style="width: 100%"
                                                                [(ngModel)]="
                                                                    result[item.TABLE_COLUMN_CODE]
                                                                "
                                                                (click)="
                                                                    psnBaseInfoIfy.evtClick(
                                                                        $event,
                                                                        item,
                                                                        result
                                                                    )
                                                                "
                                                                (ngModelChange)="
                                                                    psnBaseInfoIfy.evtBlur(
                                                                        $event,
                                                                        item,
                                                                        result
                                                                    )
                                                                "
                                                            ></datetime-input>
                                                        </ng-template>
                                                        <ng-template ngSwitchDefault>
                                                            <input
                                                                [(ngModel)]="
                                                                    result[item.TABLE_COLUMN_CODE]
                                                                "
                                                                (click)="
                                                                    psnBaseInfoIfy.evtClick(
                                                                        $event,
                                                                        item,
                                                                        result
                                                                    )
                                                                "
                                                                (blur)="
                                                                    psnBaseInfoIfy.evtBlur(
                                                                        $event,
                                                                        item,
                                                                        result
                                                                    )
                                                                "
                                                            />
                                                        </ng-template>
                                                    </ng-container>
                                                </ng-container>
                                            </ng-template>
                                        </ng-template>
                                    </td>
                                </ng-container>
                                <ng-container *ngIf="item.TABLE_COLUMN_CODE === 'A0149'">
                                    <td class="value value_readly">
                                        {{ result['A0149'] }}
                                    </td>
                                </ng-container>
                            </ng-container>
                        </ng-container>
                    </tr>
                </ng-container>
            </tbody>
        </table>
    </div>
</ng-template>
<!-- 代码型录入  -->
<dictionary-drawer
    [code]="codeListIfy.codeId"
    (confirmChange)="codeListIfy.evtTextChange()"
    [(value)]="codeListIfy.value"
    [(text)]="codeListIfy.text"
    [(visible)]="codeListIfy.visible"
    [filterWay]="codeListIfy.status"
    [filterItems]="codeListIfy.filterItems"
>
</dictionary-drawer>

<!-- A01Child -->
<ng-template #tableChildTemp let-TABLE_CODE="TABLE_CODE" let-fields="fields" let-result="result">
    <div class="layout">
        <div class="header A01Child_header" [hidden]="!canEdit">
            <div>
                <i
                    class="special_icon opreate_icon"
                    nz-icon
                    [nzType]="'arrow-up'"
                    nz-tooltip
                    nzTooltipTitle="上移"
                    (click)="psnBaseInfoIfy.moveSelectedTableRow('up')"
                ></i>
            </div>
            <div>
                <i
                    class="special_icon opreate_icon"
                    nz-icon
                    [nzType]="'arrow-down'"
                    nz-tooltip
                    nzTooltipTitle="下移"
                    (click)="psnBaseInfoIfy.moveSelectedTableRow('down')"
                ></i>
            </div>

            <div
                (click)="batchGZ06DrawerIfy.open()"
                [hidden]="psnBaseInfoIfy.list[psnBaseInfoIfy.currentTabIndex].TABLE_CODE !== 'GZ06'"
            >
                <i
                    class="special_icon opreate_icon"
                    nz-icon
                    [nzType]="'file-add'"
                    nz-tooltip
                    nzTooltipTitle="批量考核"
                ></i>
            </div>
        </div>
        <div class="container">
            <div class="view view_table">
                <table class="custom_table">
                    <thead>
                        <tr>
                            <ng-container *ngFor="let item of fields">
                                <th class="label">
                                    {{ item.TABLE_COLUMN_NAME }}
                                </th>
                            </ng-container>
                            <th *ngIf="canEdit">操作</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr
                            *ngFor="let row of result; let i = index"
                            (click)="psnBaseInfoIfy.selectedRow(row)"
                            [class.active]="row === psnBaseInfoIfy.currentSelectedRow"
                        >
                            <td class="sort_value">
                                {{
                                    (psnBaseInfoIfy.pagination.pageIndex - 1) *
                                        psnBaseInfoIfy.pagination.pageSize +
                                        (i + 1)
                                }}
                            </td>

                            <ng-container *ngFor="let item of fields; index as j">
                                <td
                                    class="value"
                                    [attr.columnName]="item.TABLE_COLUMN_CODE"
                                    [class.value_date]="item.TABLE_COLUMN_TYPE === 4"
                                    *ngIf="j > 0"
                                >
                                    <ng-container
                                        *ngIf="
                                            item.TABLE_COLUMN_DICTIONARY_CODE;
                                            else elseGeneralChildTemplate
                                        "
                                    >
                                        <input
                                            [class.active]="
                                                row === psnBaseInfoIfy.currentSelectedRow
                                            "
                                            [readOnly]="item.TABLE_COLUMN_DICTIONARY_CODE"
                                            [(ngModel)]="row[item.TABLE_COLUMN_CODE + '_CN']"
                                            (click)="psnBaseInfoIfy.evtClick($event, item, row)"
                                        />
                                    </ng-container>
                                    <ng-template #elseGeneralChildTemplate>
                                        <ng-container [ngSwitch]="item.TABLE_COLUMN_TYPE">
                                            <ng-template [ngSwitchCase]="4">
                                                <datetime-input
                                                    [class.active]="
                                                        row === psnBaseInfoIfy.currentSelectedRow
                                                    "
                                                    nzMin="0"
                                                    style="width: 100%"
                                                    [(ngModel)]="row[item.TABLE_COLUMN_CODE]"
                                                    (blur)="
                                                        psnBaseInfoIfy.evtBlur($event, item, row)
                                                    "
                                                ></datetime-input>
                                            </ng-template>
                                            <ng-template ngSwitchDefault>
                                                <input
                                                    [class.active]="
                                                        row === psnBaseInfoIfy.currentSelectedRow
                                                    "
                                                    [(ngModel)]="row[item.TABLE_COLUMN_CODE]"
                                                    (blur)="
                                                        psnBaseInfoIfy.evtBlur($event, item, row)
                                                    "
                                                />
                                            </ng-template>
                                        </ng-container>
                                    </ng-template>
                                </td>
                            </ng-container>
                            <td *ngIf="canEdit">
                                <a (click)="psnBaseInfoIfy.evtDeleteData(row)">删除</a>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
        <div class="footer pagination">
            <nz-pagination
                nzShowSizeChanger
                [nzPageSizeOptions]="[5, 10, 20, 50]"
                [nzTotal]="psnBaseInfoIfy.pagination.total"
                [(nzPageIndex)]="psnBaseInfoIfy.pagination.pageIndex"
                (nzPageIndexChange)="psnBaseInfoIfy.pagination.pageChange()"
                [(nzPageSize)]="psnBaseInfoIfy.pagination.pageSize"
                (nzPageSizeChange)="psnBaseInfoIfy.pagination.pageChange(true)"
            ></nz-pagination>
        </div>
    </div>
</ng-template>

<!-- 工资情况 -->
<ng-template #otherInfoTemplate>
    <div [class.full_screen]="isDownFullScreen">
        <div class="layout">
            <div class="header tabset_header">
                <div>
                    <nz-tabset
                        nzType="card"
                        nzTabPosition="top"
                        [(nzSelectedIndex)]="psnSalaryInfoIfy.currentTabIndex"
                        [nzSize]="'small'"
                        [nzTabBarStyle]="{
                            'margin.px': 0,
                            'height.px': 50,
                            'padding-top.px': 10
                        }"
                        (nzSelectedIndexChange)="psnSalaryInfoIfy.evtTabChange()"
                    >
                        <nz-tab
                            *ngFor="let item of psnSalaryInfoIfy.list"
                            [nzTitle]="item.TABLE_NAME"
                        ></nz-tab>
                    </nz-tabset>
                </div>

                <!-- <div class="tabset_extra">
                    <div class="arrows" (click)="evtUpDownArrows('down')">
                        <i class="fa fa-arrows-alt"></i>
                    </div>
                </div> -->
            </div>
            <div class="container">
                <ng-container *ngFor="let item of psnSalaryInfoIfy.list">
                    <div
                        class="view_scroll view_table"
                        [hidden]="
                            !(
                                item.TABLE_CODE ===
                                psnSalaryInfoIfy.list[psnSalaryInfoIfy.currentTabIndex].TABLE_CODE
                            )
                        "
                    >
                        <ng-template
                            [ngTemplateOutlet]="item.PSN ? GZDA07Temp : GZTableTemp"
                            [ngTemplateOutletContext]="{
                                fields: item.fields,
                                result: item.PSN ? item.result : item.data
                            }"
                        ></ng-template>
                    </div>
                </ng-container>
            </div>
            <div
                [hidden]="
                    psnSalaryInfoIfy.list[psnSalaryInfoIfy.currentTabIndex].TABLE_CODE === 'GZDA07'
                "
                class="footer pagination"
            >
                <nz-pagination
                    nzShowSizeChanger
                    [nzPageSizeOptions]="[5, 10, 20, 50]"
                    [nzTotal]="psnSalaryInfoIfy.pagination.total"
                    [(nzPageIndex)]="psnSalaryInfoIfy.pagination.pageIndex"
                    (nzPageIndexChange)="psnSalaryInfoIfy.pagination.pageChange()"
                    [(nzPageSize)]="psnSalaryInfoIfy.pagination.pageSize"
                    (nzPageSizeChange)="psnSalaryInfoIfy.pagination.pageChange(true)"
                ></nz-pagination>
            </div>
        </div>
    </div>
</ng-template>

<!-- GZDA07 -->
<ng-template #GZDA07Temp let-TABLE_CODE="TABLE_CODE" let-fields="fields" let-result="result">
    <table class="custom_table">
        <tbody>
            <ng-container *ngFor="let f of fields; let row = index">
                <tr *ngIf="row % 3 === 0">
                    <ng-container *ngFor="let item of fields; let column = index">
                        <ng-container *ngIf="column >= row && column < row + 3">
                            <td class="label" [attr.columnName]="item.TABLE_COLUMN_CODE">
                                {{ item.TABLE_COLUMN_NAME }}
                            </td>
                            <td class="value">
                                <ng-container
                                    *ngIf="
                                        item?.TABLE_COLUMN_DICTIONARY_CODE;
                                        else elseGeneralTemplate
                                    "
                                >
                                    {{ result[item.TABLE_COLUMN_CODE + '_CN'] || '' }}
                                </ng-container>
                                <ng-template #elseGeneralTemplate>
                                    <ng-container
                                        *ngIf="item.TABLE_COLUMN_CODE !== 'GZDA0705_GZDA0712'"
                                    >
                                        {{ result[item.TABLE_COLUMN_CODE] || '' }}
                                    </ng-container>

                                    <ng-container
                                        *ngIf="item.TABLE_COLUMN_CODE === 'GZDA0705_GZDA0712'"
                                    >
                                        {{ result['GZDA0705_CN'] }} {{ result['GZDA0712_CN'] }}
                                    </ng-container>
                                </ng-template>
                            </td>
                        </ng-container>
                    </ng-container>
                </tr>
            </ng-container>
        </tbody>
    </table>
</ng-template>

<!-- 除GZDA07之外的子集 -->
<ng-template #GZTableTemp let-TABLE_CODE="TABLE_CODE" let-fields="fields" let-result="result">
    <table class="custom_table">
        <thead>
            <tr>
                <ng-container *ngFor="let item of fields">
                    <th class="label" [attr.columnName]="item.TABLE_COLUMN_CODE">
                        {{ item.TABLE_COLUMN_NAME }}
                    </th>
                </ng-container>
            </tr>
        </thead>
        <tbody>
            <tr *ngFor="let row of result; let i = index">
                <td class="sort_value">
                    {{
                        (psnSalaryInfoIfy.pagination.pageIndex - 1) *
                            psnSalaryInfoIfy.pagination.pageSize +
                            (i + 1)
                    }}
                </td>
                <ng-container *ngFor="let item of fields; index as j">
                    <td *ngIf="j > 0" class="value" [attr.columnName]="item.TABLE_COLUMN_CODE">
                        <ng-container
                            *ngIf="item.TABLE_COLUMN_DICTIONARY_CODE; else elseGZDA07ChildTemplate"
                        >
                            {{ row[item.TABLE_COLUMN_CODE + '_CN'] || '' }}
                        </ng-container>
                        <ng-template #elseGZDA07ChildTemplate>
                            {{ row[item.TABLE_COLUMN_CODE] }}
                        </ng-template>
                    </td>
                </ng-container>
            </tr>
        </tbody>
    </table>
</ng-template>

<!-- 津补贴 -->
<ng-template #AllowTable>
    <allowance-table
        [isUsable]="canEdit"
        [jobStepInfo]="jobStepInfo"
        [person]="personListIfy.selectedPsnData?.keyId"
        [isImport]="isExistNewPerson"
        [isUpdate]="psnSalaryInfoIfy.isUpdateAllow"
        (calculateChange)="psnSalaryInfoIfy.updateSalaryChilds()"
    ></allowance-table>
    <!-- (calculateChange)="psnSalaryInfoIfy.updateSalaryChilds()"---计算后刷新核定工资表格 -->
</ng-template>

<!-- 工龄情况 -->
<standing-change
    #StandingChangeComponent
    [personInf]="personListIfy.selectedPsnData?.keyId"
    [jobStepInfo]="jobStepInfo"
    (saveChange)="this.psnBaseInfoIfy.evtSaveChildData()"
></standing-change>

<!-- 批量审核抽屉 -->
<nz-drawer
    [nzVisible]="batchGZ06DrawerIfy.visible"
    [nzWidth]="500"
    [nzTitle]="'批量审核'"
    (nzOnClose)="batchGZ06DrawerIfy.close()"
>
    <div class="drawer_area">
        <div class="container">
            <div class="view">
                <form nz-form [formGroup]="batchGZ06DrawerIfy.form">
                    <nz-form-item>
                        <nz-form-label nzRequired>请输入要批量添加考核的开始年份</nz-form-label>
                        <nz-form-control nzErrorTip="开始年份不能为空。">
                            <input
                                nz-input
                                formControlName="startYear"
                                (blur)="
                                    batchGZ06DrawerIfy.evtBlur(
                                        'startYear',
                                        batchGZ06DrawerIfy.form.get('startYear').value
                                    )
                                "
                            />
                        </nz-form-control>
                    </nz-form-item>
                    <nz-form-item>
                        <nz-form-label nzRequired>请输入要批量添加考核的结束年份</nz-form-label>
                        <nz-form-control nzErrorTip="结束年份不能为空。">
                            <input
                                nz-input
                                formControlName="endYear"
                                (blur)="
                                    batchGZ06DrawerIfy.evtBlur(
                                        'endYear',
                                        batchGZ06DrawerIfy.form.get('endYear').value
                                    )
                                "
                            />
                        </nz-form-control>
                    </nz-form-item>
                    <nz-form-item>
                        <nz-form-label nzRequired>请输入要批量考核的考核结果</nz-form-label>
                        <nz-form-control nzErrorTip="考核结果不能为空。">
                            <input
                                nz-input
                                formControlName="examResult"
                                [readOnly]="'CGZCC'"
                                (click)="batchGZ06DrawerIfy.evtClick()"
                            />
                        </nz-form-control>
                    </nz-form-item>
                </form>
            </div>
        </div>

        <div class="footer">
            <nz-button-group>
                <button nz-button nzType="primary" (click)="batchGZ06DrawerIfy.save()">确定</button>
                <button nz-button nzType="primary" (click)="batchGZ06DrawerIfy.close()">
                    取消
                </button>
            </nz-button-group>
        </div>
    </div>
</nz-drawer>

<ng-template #personFileTemp>
    <civil-inner-transfer-person-file
        style="width: 100%"
        [jobStepInfo]="jobStepInfo"
        [currentSelectedPsnData]="personListIfy.selectedPsnData"
        [refreashFileLists]="personListIfy.refreashPsnFile"
    ></civil-inner-transfer-person-file>
</ng-template>

<!-- 校验信息 -->
<nz-drawer
    [nzClosable]="true"
    [nzVisible]="dataVerificationIfy.visible"
    nzPlacement="right"
    nzTitle="校验信息"
    [nzWidth]="dataVerificationIfy.width"
    (nzOnClose)="dataVerificationIfy.close()"
>
    <div class="drawer_area">
        <nz-table
            nzBordered
            nzSize="small"
            #dataVerificationTblElement
            [nzData]="dataVerificationIfy.list"
        >
            <thead>
                <tr>
                    <th>姓名</th>
                    <th>错误信息</th>
                </tr>
            </thead>
            <tbody>
                <tr *ngFor="let data of dataVerificationTblElement.data">
                    <td>{{ data.keyName }}</td>
                    <td>{{ data.result }}</td>
                </tr>
            </tbody>
        </nz-table>
    </div>
</nz-drawer>

<civil-inner-transfer-wfinfo-drawer
    #wfInfoDrawerElement
    [type]="wfInfoDrawer.sign"
    [isChange]="wfInfoDrawer.changeStatus"
    [jobStepInfo]="jobStepInfo"
></civil-inner-transfer-wfinfo-drawer>
