<div class="layout">
    <div class="header header_padding">
        <div class="header_tabs">
            <nz-tabset 
                [nzTabBarStyle]="{ 'margin.px': 0, 'height.px': 50 }" 
                nzType="card"
                [(nzSelectedIndex)]="tabs.currentIndex"
                (nzSelectedIndexChange)="tabs.SelectedIndexChange($event)">
                <ng-container *ngFor="let item of tabs.list">
                    <nz-tab [nzTitle]="item"></nz-tab>
                </ng-container>
            </nz-tabset>
        </div>
        <div class="right prompt_message header_step">
            <i nz-icon nzType="info-circle" nzTheme="fill"></i>
            <b>{{ promptMessage.headerTabs.title }}：</b>
            <span>{{ promptMessage.headerTabs.message }}</span>
        </div>
    </div>
    <div class="container">
        <ng-template [ngTemplateOutlet]="before"></ng-template>
    </div>
</div>

<ng-template #before>
    <div class="layout">
        <div class="header header_padding">
            <div class="header_btn">
                <button nz-button nzType="primary" (click)="personDrawer.open()">选择测算人员</button>
                <button nz-button nzType="primary" (click)="createNewPerson.add()">新增测算人员</button>
                <button nz-button (click)="savePerson()">存档</button>
                <button nz-button (click)="showSaveData.open()">查看存档信息</button>
                <div class="message_right prompt_message header_btn_step">
                    <i nz-icon nzType="info-circle" nzTheme="fill"></i>
                    <b>{{ promptMessage.headerBtn.title }}：</b>
                    <span>{{ isChangeBefor ? promptMessage.headerBtn.message : promptMessage.headerBtn.afterMessage }}</span>
                </div>
            </div>
        </div>
        <div class="loading" *ngIf="isLoading">
            <nz-spin nzSimple></nz-spin>
        </div>
        <div class="container" *ngIf="isNewCreate || selectPersonInfo?.DATA_3001_PERSON_A01_ID">
            <div class="view_scroll content">
                <div>
                    <div class="layout">
                        <div class="container">
                            <div class="right">
                                <h3 class="title">
                                    <b>
                                        1、{{ isChangeBefor ? '工改时（2006-6-30）信息' : '参加工作时信息'}}
                                    </b>
                                    <button nz-button nzType="primary" (click)="jobChanging.saveFormData()">保存</button>
                                </h3>
                                <nz-tabset 
                                    [nzTabBarStyle]="{ 'margin.px': 0, 'height.px': 30 }" 
                                    nzType="card"
                                    [(nzSelectedIndex)]="jobChangingTabs.currentIndex">
                                    <ng-container *ngFor="let item of jobChangingTabs.list; let i = index">
                                        <nz-tab [nzTitle]="'('+ (i+1) +')'+item"></nz-tab>
                                    </ng-container>
                                </nz-tabset>
                                <div class="form_scroll">
                                    <ng-template [ngTemplateOutlet]="[identity, workInfo, workTime][jobChangingTabs.currentIndex]"></ng-template>
                                </div>
                            </div>
                            <div class="left first_step">
                                <div class="prompt_message">
                                    <i nz-icon nzType="info-circle" nzTheme="fill"></i>
                                    <b>{{ promptMessage.firstStep.title }}：</b>
                                    <ng-container *ngIf="(!isChangeBefor) && promptMessage.firstStep.afterList; else elseFirstTip">
                                        <ng-container *ngFor="let item of promptMessage.firstStep.afterList; let i = index">
                                            <div class="list_text">
                                                {{ i + 1 }}、{{ item }}
                                            </div>
                                        </ng-container>
                                    </ng-container>
                                    <ng-template #elseFirstTip>
                                        <ng-container *ngFor="let item of promptMessage.firstStep.list; let i = index">
                                            <div class="list_text">
                                                {{ i + 1 }}、{{ item }}
                                            </div>
                                        </ng-container>
                                    </ng-template>
                                </div>
                            </div>
                        </div>
                    </div>
                    <nz-divider class="form_divider"></nz-divider>
                </div>

                <div>
                    <h3 class="title">
                        <b>
                            2、{{ isChangeBefor ? '工改后信息变动情况' : '参加工作后信息变动情况'}}
                        </b>
                    </h3>
                    <nz-tabset 
                        [nzTabBarStyle]="{ 'margin.px': 0, 'marginBottom.px': 10, 'height.px': 30 }" 
                        nzType="card"
                        [(nzSelectedIndex)]="jobChangeAfter.currentIndex"
                        (nzSelectedIndexChange)="jobChangeAfter.selectIndexChange($event)">
                        <ng-container *ngFor="let item of jobChangeAfter.list; let i = index">
                            <nz-tab [nzTitle]="'2.'+ (i+1) +item.text"></nz-tab>
                        </ng-container>
                    </nz-tabset>
                    <div>
                        <div class="layout">
                            <div class="container">
                                <div class="right">
                                    <div class="title">
                                        <b>
                                            {{ jobChangeAfter.list[jobChangeAfter.currentIndex].text }}情况
                                        </b>
                                    </div>
                                    <nz-table 
                                        class="mr10"
                                        #basicTable 
                                        [nzShowPagination]="false"
                                        [nzData]="jobChangeAfterTabel.list[jobChangeAfter.currentIndex]" 
                                        [nzBordered]="true"
                                        [nzLoading]="jobChangeAfterTabel.tabLoading"
                                        [nzSize]="'small'">
                                        <thead>
                                            <tr>
                                                <ng-container *ngFor="let head of jobChangeAfterTabel.tableHeader[jobChangeAfter.currentIndex]">
                                                    <th>{{ head.SCHEME_HEADER_DISPLAY_NAME }}</th>
                                                </ng-container>
                                                <th nzAlign="center" nzWidth="220px">操作</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr *ngFor="let data of basicTable.data; let i = index">
                                                <ng-container *ngFor="let item of jobChangeAfterTabel.tableHeader[jobChangeAfter.currentIndex]">
                                                    <td>
                                                        <ng-container *ngIf="item.TABLE_COLUMN_TYPE === 4; else elseTemplateInput">
                                                            {{ data[item.TABLE_COLUMN_CODE] | date: 'yyyy-MM-dd' }}
                                                        </ng-container>
                                                        <ng-template #elseTemplateInput>
                                                            {{ item.TABLE_COLUMN_DICTIONARY_CODE 
                                                                ? data[item.TABLE_COLUMN_CODE+'_CN']
                                                                : data[item.TABLE_COLUMN_CODE]
                                                            }}
                                                        </ng-template>
                                                    </td>
                                                </ng-container>
                                                <td nzAlign="center">
                                                    <a 
                                                        nz-button 
                                                        [nzLoading]="jobChangeAfterTabel.delLoading"  
                                                        nzType="link" 
                                                        (click)="jobChangeAfterTabel.delete(i)">
                                                        删除
                                                    </a>
                                                </td>
                                            </tr>
                                            <tr>
                                                <ng-container *ngFor="let item of jobChangeAfterTabel.tableHeader[jobChangeAfter.currentIndex]">
                                                    <td>
                                                        <ng-container *ngIf="item.TABLE_COLUMN_DICTIONARY_CODE; else elseTemplateEdit">
                                                            <dictionary-input 
                                                                [code]="item.TABLE_COLUMN_DICTIONARY_CODE"
                                                                [(text)]="jobChangeAfterTabel.addData[item.TABLE_COLUMN_CODE+'_CN']"
                                                                [placeholder]="'请填写' + item.SCHEME_HEADER_DISPLAY_NAME"
                                                                [(ngModel)]="jobChangeAfterTabel.addData[item.TABLE_COLUMN_CODE]">
                                                            </dictionary-input>
                                                        </ng-container>
                                                        <ng-template #elseTemplateEdit>
                                                            <ng-container [ngSwitch]="item.TABLE_COLUMN_TYPE">
                                                                <ng-template [ngSwitchCase]="columnType.DATE">
                                                                    <datetime-input 
                                                                        [(ngModel)]="jobChangeAfterTabel.addData[item.TABLE_COLUMN_CODE]" 
                                                                        [placeholder]="'请填写' + item.SCHEME_HEADER_DISPLAY_NAME">
                                                                    </datetime-input>
                                                                </ng-template>
                                                                <ng-template [ngSwitchCase]="columnType.NUMBER">
                                                                    <nz-input-number 
                                                                        class="tab_width"
                                                                        [(ngModel)]="jobChangeAfterTabel.addData[item.TABLE_COLUMN_CODE]"
                                                                        [nzPlaceHolder]="'请填写' + item.SCHEME_HEADER_DISPLAY_NAME">
                                                                    </nz-input-number>
                                                                </ng-template>
                                                                <ng-template [ngSwitchCase]="columnType.CLOB">
                                                                    <textarea 
                                                                        nz-input 
                                                                        class="tab_width"
                                                                        [(ngModel)]="jobChangeAfterTabel.addData[item.TABLE_COLUMN_CODE]"
                                                                        [placeholder]="'请填写' + item.SCHEME_HEADER_DISPLAY_NAME">
                                                                    </textarea>
                                                                </ng-template>
                                                                <ng-template ngSwitchDefault>
                                                                    <input 
                                                                        class="tab_width"
                                                                        [(ngModel)]="jobChangeAfterTabel.addData[item.TABLE_COLUMN_CODE]" 
                                                                        [placeholder]="'请填写' + item.SCHEME_HEADER_DISPLAY_NAME"/>
                                                                </ng-template>
                                                            </ng-container>
                                                        </ng-template>
                                                    </td>
                                                </ng-container>
                                                <td nzAlign="center">
                                                    <a 
                                                        nz-button 
                                                        [nzLoading]="jobChangeAfterTabel.saveLoading"  
                                                        nzType="link" 
                                                        (click)="jobChangeAfterTabel.save()">
                                                        保存 
                                                    </a>
                                                    <a nz-button nzType="link" (click)="jobChangeAfterTabel.cancel()"> 取消</a>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </nz-table>
                                </div>
                                <div class="left second_step">
                                    <div class="prompt_message">
                                        <i nz-icon nzType="info-circle" nzTheme="fill"></i>
                                        <b>{{ promptMessage.secondStep.title }}：</b>
                                        <ng-container *ngIf="!isChangeBefor && jobChangeAfter.list[jobChangeAfter.currentIndex].afterMsgList; else elseTipTemplate">
                                            <ng-container *ngFor="let item of jobChangeAfter.list[jobChangeAfter.currentIndex].afterMsgList; let i = index">
                                                <div class="list_text">
                                                    {{ i + 1 }}、{{ item }}
                                                </div>
                                            </ng-container>
                                        </ng-container>

                                        <ng-template #elseTipTemplate>
                                            <ng-container *ngFor="let item of jobChangeAfter.list[jobChangeAfter.currentIndex].msgList; let i = index">
                                                <div class="list_text">
                                                    {{ i + 1 }}、{{ item }}
                                                </div>
                                            </ng-container>
                                        </ng-template>
                                    </div>
                                </div>
                            </div>
                            
                        </div>
                        
                    </div>
                    <nz-divider class="content_divider"></nz-divider>
                </div>

                <div>
                    <div>
                        <h3 class="title display_inlineb">
                            <b>
                                3、测算终止时间：
                            </b>
                            <div class="display_inlineb">
                                <datetime-input 
                                    [(ngModel)]="finishTime.date" 
                                    [placeholder]="'请填写测算终止时间'">
                                </datetime-input>
                            </div>
                        </h3>
                        <div class="message_right prompt_message third_step">
                            <i nz-icon nzType="info-circle" nzTheme="fill"></i>
                            <b>{{ promptMessage.thirdStep.title }}：</b>
                            <span>{{ promptMessage.thirdStep.message }}</span>
                        </div>
                    </div>
                    
                    <div class="calculate">
                        <div class="calculate_start">
                            <button 
                                nz-button 
                                (click)="finishTime.clear()" 
                                [nzLoading]="finishTime.clearLoading">清空所有信息</button>
                            <button 
                                nz-button 
                                nzType="primary" 
                                (click)="finishTime.startCalculate()"
                                [nzLoading]="finishTime.calcLoading">开始测算</button>
                        </div>
                    </div>
                </div>

                <div>
                    <div>
                        <h3 class="title">
                            <b class="display_inlineb">
                                4、当前人员是：{{ selectPersonInfo?.A0151_CN }}，测算结果如下
                            </b>
                        </h3>
                    </div>
                    <div [class.fullscreen]="isFullScreen">
                        <ng-container *ngIf="isChangeBefor">
                            <nz-button-group class="btn_group">
                                <button 
                                    class="left_btn" 
                                    nz-button 
                                    [nzType]="salaryResult.mode === 0 ? 'primary' : ''"
                                    (click)="salaryResult.tabsChange(0)">
                                    工资变迁
                                </button>
                                <button 
                                    class="right_btn" 
                                    nz-button 
                                    [nzType]="salaryResult.mode === 1 ? 'primary' : ''"
                                    (click)="salaryResult.tabsChange(1)">
                                    套改情况
                                </button>
                            </nz-button-group>
                        </ng-container>
                        <ng-container *ngIf="!isChangeBefor" >
                            <div>
                                <button nz-button nzType="primary">
                                    工资变迁
                                </button>
                            </div>
                        </ng-container>
                        <div class="message_right prompt_message">
                            <i nz-icon nzType="info-circle" nzTheme="fill"></i>
                            <b>{{ promptMessage.fourthStep.title }}：</b>
                            <span>{{ promptMessage.fourthStep.message }}</span>
                        </div>
                        <div class="result_table">
                            <div class="resault_loading" *ngIf="salaryResult.loading">
                                <nz-spin nzSimple></nz-spin>
                            </div>
                            <div class="fullscreen_ico" (click)="isFullScreen = !isFullScreen">
                                <i nz-icon nzType="fullscreen" nzTheme="outline"></i>
                            </div>
                            <nz-table 
                                class="tab_width"
                                #salaryResultTable 
                                [nzData]="salaryResult.list" 
                                [nzBordered]="true" 
                                [nzSize]="'small'"
                                [nzScroll]="{ x: '1200px'}"
                                [nzFrontPagination]="true"
                                [nzTotal]="salaryResult.total"
                                [(nzPageIndex)]="salaryResult.pageIndex"
                                [nzPageSize]="salaryResult.pageSize"
                                [nzShowSizeChanger]="true"
                                [nzPageSizeOptions]="salaryResult.pageSizeOptions">
                                <thead>
                                    <tr>
                                        <th [nzWidth]="'60px'">序号</th>
                                        <ng-container *ngFor="let head of salaryResult.tableHeader[salaryResult.mode]">
                                            <th [nzWidth]="head.SCHEME_HEADER_DISPLAY_WIDTH + 'px'">
                                                {{ head.SCHEME_HEADER_DISPLAY_NAME }}
                                            </th>
                                        </ng-container>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr *ngFor="let data of salaryResultTable.data; let i = index">
                                        <td>
                                            {{
                                                (salaryResult.pageIndex - 1)*salaryResult.pageSize + i + 1
                                            }}
                                        </td>
                                        <ng-container *ngFor="let item of salaryResult.tableHeader[salaryResult.mode]">
                                            <td>
                                                <ng-container *ngIf="item.TABLE_COLUMN_TYPE === 4; else elseResultInput">
                                                    {{ data[item.TABLE_COLUMN_CODE] | date: 'yyyy-MM-dd' }}
                                                </ng-container>
                                                <ng-template #elseResultInput>
                                                    {{ item.TABLE_COLUMN_DICTIONARY_CODE
                                                    ? data[item.TABLE_COLUMN_CODE+'_CN']
                                                    : data[item.TABLE_COLUMN_CODE]
                                                    }}
                                                </ng-template>
                                            </td>
                                        </ng-container>
                                    </tr>
                                </tbody>
                            </nz-table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 身份学历 -->
    <ng-template #identity>
        <form class="padding_top" nz-form [formGroup]="jobChanging.identityForm" >
            <nz-form-item class="identity_item">
                <nz-form-label>身份</nz-form-label>
                <nz-form-control>
                    <dictionary-input 
                        [filterItems]="['11', '21', '31', '32', '33', '50', '90', '99']"
                        code="CAD"
                        [(text)]="selectPersonInfo['A0151_CN']"
                        placeholder="请填写人员身份"
                        formControlName="A0151">
                    </dictionary-input>
                </nz-form-control>
            </nz-form-item>
            <nz-form-item class="identity_item">
                <nz-form-label>学历</nz-form-label>
                <nz-form-control>
                    <dictionary-input 
                        code="CGZZB"
                        [(text)]="selectPersonInfo.eduInfo['GZ0101_CN']"
                        placeholder="请填写学历"
                        formControlName="GZ0101">
                    </dictionary-input>
                </nz-form-control>
            </nz-form-item>
        </form>
    </ng-template>

    <!-- 任职情况 -->
    <ng-template #workInfo>
        <!-- 套改前 -->
        <ng-container *ngIf="isChangeBefor; else workInfoAfter">
            <ng-container *ngFor="let item of [1, 2]; let i = index">
                <form 
                    class="padding_top workInfo"
                    nz-form 
                    [formGroup]="item === 1 ? jobChanging.workInfoForm : jobChanging.lowWorkForm">
                    <div nz-row class="label_padding">
                        <div nz-col [nzSpan]="6">
                            <nz-form-item>
                                <nz-form-label 
                                    [nzNoColon]="true" 
                                    class="label_left">
                                    {{ item === 1 ? '(1)2006-06-30时任' : '(2)低一职务' }}
                                </nz-form-label>
                                <nz-form-control>
                                    <ng-container *ngIf="i === 0; else elseTemplate">
                                        <dictionary-input 
                                            code="CGZCQRZDB"
                                            [(text)]="jobOptions['GZ0232_CN']"
                                            placeholder="请填写职务"
                                            formControlName="GZ0232">
                                        </dictionary-input>
                                    </ng-container>
                                    <ng-template #elseTemplate>
                                        <dictionary-input 
                                            code="CGZCQRZDB"
                                            [(text)]="beforJobOptions['GZ0232_CN']"
                                            placeholder="请填写职务"
                                            formControlName="GZ0232">
                                        </dictionary-input>
                                    </ng-template>
                                </nz-form-control>
                            </nz-form-item>
                        </div>
                        <div nz-col [nzSpan]="5">
                            <nz-form-item>
                                <nz-form-label [nzNoColon]="true">任职时间</nz-form-label>
                                <nz-form-control >
                                    <datetime-input 
                                        formControlName="GZ0206" 
                                        [placeholder]="'请填写任职时间'">
                                    </datetime-input>
                                </nz-form-control>
                                <span class="date_tail">年</span>
                            </nz-form-item>
                        </div>
                        <div nz-col [nzSpan]="5">
                            <nz-form-item>
                                <nz-form-label [nzNoColon]="true">是否领导</nz-form-label>
                                <nz-form-control>
                                    <ng-container *ngIf="i === 0; else elseIsLeader">
                                        <dictionary-input 
                                            code="CGZZR"
                                            [(text)]="jobOptions['GZ0208_CN']"
                                            placeholder="请填写是否领导"
                                            formControlName="GZ0208">
                                        </dictionary-input>
                                    </ng-container>
                                    <ng-template #elseIsLeader>
                                        <dictionary-input 
                                            code="CGZZR"
                                            [(text)]="beforJobOptions['GZ0208_CN']"
                                            placeholder="请填写是否领导"
                                            formControlName="GZ0208">
                                        </dictionary-input>
                                    </ng-template>
                                </nz-form-control>
                            </nz-form-item>
                        </div>
                        <div nz-col [nzSpan]="4">
                            <nz-form-item>
                                <nz-form-label [nzNoColon]="true">间断</nz-form-label>
                                <nz-form-control>
                                    <nz-input-group [nzSuffix]="suffixIconEdit">
                                        <input 
                                            nz-input 
                                            formControlName="gapYear" 
                                            (input)="jobChanging.calJobInfoLimit(i)" />
                                    </nz-input-group>
                                </nz-form-control>
                                <span class="date_tail">年</span>
                            </nz-form-item>
                        </div>
                        <div nz-col [nzSpan]="4">
                            <nz-form-item>
                                <nz-form-label [nzNoColon]="true">任职年限</nz-form-label>
                                <nz-form-control>
                                    <input nz-input formControlName="yearsLimit" />
                                </nz-form-control>
                                <span class="date_tail">年</span>
                            </nz-form-item>
                        </div>
                    </div>
                </form>
            </ng-container>
        </ng-container>
        <!-- 套改后 -->
        <ng-template #workInfoAfter>
            <form class="padding_top workInfo" nz-form
                [formGroup]="jobChanging.workInfoForm">
                <div nz-row class="label_padding">
                    <div nz-col [nzSpan]="6">
                        <nz-form-item>
                            <nz-form-label [nzNoColon]="true">参加工作（转正定级）时任</nz-form-label>
                            <nz-form-control>
                                <dictionary-input 
                                    code="CGZCQRZDB"
                                    [(text)]="jobOptions['GZ0232_CN']"
                                    placeholder="请填写职务"
                                    formControlName="GZ0232">
                                </dictionary-input>
                            </nz-form-control>
                        </nz-form-item>
                    </div>
                    <div nz-col [nzSpan]="5">
                        <nz-form-item>
                            <nz-form-label [nzNoColon]="true">任职时间</nz-form-label>
                            <nz-form-control>
                                <datetime-input 
                                    formControlName="GZ0206" 
                                    [placeholder]="'请填写任职时间'">
                                </datetime-input>
                            </nz-form-control>
                            <span class="date_tail">年</span>
                        </nz-form-item>
                    </div>
                    <div nz-col [nzSpan]="5">
                        <nz-form-item>
                            <nz-form-label [nzNoColon]="true">是否领导</nz-form-label>
                            <nz-form-control>
                                <dictionary-input 
                                    code="CGZZR"
                                    [(text)]="jobOptions['GZ0208_CN']"
                                    placeholder="请填写是否领导"
                                    formControlName="GZ0208">
                                </dictionary-input>
                            </nz-form-control>
                        </nz-form-item>
                    </div>
                </div>
            </form>
        </ng-template>
    </ng-template>

    <!-- 参加工作时间 -->
    <ng-template #workTime>
        <!-- 套改前 -->
        <ng-container *ngIf="isChangeBefor; else workTimeAfter">
            <form 
                class="padding_top workInfo" 
                nz-form
                [formGroup]="jobChanging.workTimeForm">
                <div nz-row class="label_padding">
                    <div nz-col [nzSpan]="4">
                        <nz-form-item>
                            <nz-form-label [nzNoColon]="true">参加工作时间</nz-form-label>
                            <nz-form-control>
                                <datetime-input 
                                    formControlName="A0134" 
                                    [placeholder]="'请填写参加工作时间'">
                                </datetime-input>
                            </nz-form-control>
                        </nz-form-item>
                    </div>
                    <div nz-col [nzSpan]="6">
                        <nz-form-item>
                            <nz-form-label [nzNoColon]="true">大专以上未计工龄学习年限</nz-form-label>
                            <nz-form-control>
                                <input 
                                    nz-input 
                                    formControlName="W0405" 
                                    (input)="jobChanging.calWorkTimeLimit()" />
                            </nz-form-control>
                            <span class="date_tail">年</span>
                        </nz-form-item>
                    </div>
                    <div nz-col [nzSpan]="6">
                        <nz-form-item>
                            <nz-form-label [nzNoColon]="true">1993年-2006年的不称职</nz-form-label>
                            <nz-form-control>
                                <nz-input-group [nzSuffix]="suffixIconEdit">
                                    <input 
                                        nz-input 
                                        formControlName="W0152" 
                                        (input)="jobChanging.calWorkTimeLimit()" />
                                </nz-input-group>
                            </nz-form-control>
                            <span class="date_tail">年</span>
                        </nz-form-item>
                    </div>
                    <div nz-col [nzSpan]="4">
                        <nz-form-item>
                            <nz-form-label [nzNoColon]="true">工龄间断</nz-form-label>
                            <nz-form-control>
                                <nz-input-group [nzSuffix]="suffixIconEdit">
                                    <input 
                                        nz-input 
                                        formControlName="A0134B"
                                        (input)="jobChanging.calWorkTimeLimit()"  />
                                </nz-input-group>
                            </nz-form-control>
                            <span class="date_tail">年</span>
                        </nz-form-item>
                    </div>
                    <div nz-col [nzSpan]="4">
                        <nz-form-item>
                            <nz-form-label [nzNoColon]="true">套改年限</nz-form-label>
                            <nz-form-control>
                                <input nz-input formControlName="yearsLimit" />
                            </nz-form-control>
                            <span class="date_tail">年</span>
                        </nz-form-item>
                    </div>
                </div>
            </form>
        </ng-container>
        <!-- 套改后 -->
        <ng-template #workTimeAfter>
            <form class="padding_top workInfo" nz-form [formGroup]="jobChanging.workTimeForm">
                <div nz-row class="label_padding">
                    <div nz-col [nzSpan]="4">
                        <nz-form-item>
                            <nz-form-label [nzNoColon]="true">参加工作时间</nz-form-label>
                            <nz-form-control>
                                <datetime-input 
                                    formControlName="A0134" 
                                    [placeholder]="'请填写参加工作时间'">
                                </datetime-input>
                            </nz-form-control>
                        </nz-form-item>
                    </div>
                    <div nz-col [nzSpan]="4">
                        <nz-form-item>
                            <nz-form-label [nzNoColon]="true">工龄间断</nz-form-label>
                            <nz-form-control>
                                <input nz-input formControlName="A0134B" />
                            </nz-form-control>
                            <span class="date_tail">年</span>
                        </nz-form-item>
                    </div>
                </div>
            </form>
        </ng-template>
    </ng-template>
</ng-template>

<ng-template #suffixIconEdit>
    <i nz-icon nzType="edit"></i>
</ng-template>

<!-- 选择人员 -->
<nz-drawer 
    [nzClosable]="false" 
    nzPlacement="right" 
    [nzFooter]="footerTpl"
    [nzVisible]="personDrawer.visible"
    [nzTitle]="personDrawer.title" 
    [nzWidth]="personDrawer.width"
    (nzOnClose)="personDrawer.close()">
    <div class="drawer_area">
        <div class="header">
            <nz-select
                class="drawer_search"
                nzShowSearch
                nzServerSearch
                nzPlaceHolder="输入关键字查询"
                [(ngModel)]="personDrawer.find.selectedValue"
                [nzShowArrow]="false"
                [nzFilterOption]="personDrawer.find.nzFilterOption"
                (nzOnSearch)="personDrawer.find.search($event)"
                (ngModelChange)="personDrawer.find.select($event)"
                >
                <nz-option *ngFor="let o of personDrawer.find.listOfOption" [nzLabel]="o.text" [nzValue]="o.value"> </nz-option>
            </nz-select>
        </div>
        <div class="container">
            <div>
                当前选中：{{ userInfo?.unitName}}
            </div>
            <nz-table 
                #basicTable
                nzSize="small"
                [nzBordered]="true"
                [nzFrontPagination]="false"
                [nzTotal]="personDrawer.total"
                [(nzPageIndex)]="personDrawer.pageIndex"
                [nzPageSize]="personDrawer.pageSize"
                [nzData]="personDrawer.tableData"
                (nzPageIndexChange)="getPersonTableList()">
                <thead>
                    <tr>
                        <th 
                            [nzDisabled]="true"
                            [nzChecked]="personDrawer.allChecked" 
                            [nzIndeterminate]="personDrawer.indeterminate" >
                        </th>
                        <th>姓名</th>
                        <th>出生年月</th>
                        <th>参加工作时间</th>
                    </tr>
                </thead>
                <tbody>
                    <tr *ngFor="let data of basicTable.data">
                        <td nzAlign="center">
                            <label 
                                [nzDisabled]="personDrawer.currentSelect.length > 0"
                                nz-checkbox
                                [(ngModel)]="data.checked"
                                (nzCheckedChange)="personDrawer.onItemChecked($event)">
                            </label>
                        </td>
                        <td>{{ data.A0101 }}</td>
                        <td>{{ data.A0107 | date: 'yyyy-MM' }}</td>
                        <td>{{ data.A0134 | date: 'yyyy-MM-dd' }}</td>
                    </tr>
                </tbody>
            </nz-table>
            <div class="card">
                <div class="title">
                    <span>已选择人员：{{ personDrawer.currentSelect.length }}人</span>
                </div>
                <div class="card_content">
                    <ng-container *ngFor="let item of personDrawer.currentSelect">
                        <nz-tag nzMode="closeable" (nzOnClose)="personDrawer.onTagClose(item)">{{ item.A0101 }}</nz-tag>
                    </ng-container>
                </div>
            </div>
        </div>
    </div>
    <ng-template #footerTpl>
        <div>
            <button nz-button nzType="primary" (click)="personDrawer.confirmSelect()">选择人员</button>
        </div>
    </ng-template>
</nz-drawer>

<!-- 查看存档信息 -->
<nz-drawer 
    [nzClosable]="false" 
    nzPlacement="right" 
    [nzFooter]="saveDataFooter"
    [nzVisible]="showSaveData.visible"
    [nzTitle]="showSaveData.title" 
    [nzWidth]="showSaveData.width"
    (nzOnClose)="showSaveData.close()">
    <div class="drawer_area">
        <div class="container">
            <nz-table 
                #basicSaveDataTable
                nzSize="small"
                [nzBordered]="true"
                nzFrontPagination
                [(nzPageIndex)]="showSaveData.pageIndex"
                [nzPageSize]="showSaveData.pageSize"
                [nzData]="showSaveData.saveList">
                <thead>
                    <tr>
                        <th 
                            [nzDisabled]="true"
                            [nzChecked]="showSaveData.allChecked" 
                            [nzIndeterminate]="showSaveData.indeterminate" >
                        </th>
                        <th>参加工作时间</th>
                        <th>现任职情况</th>
                        <th>存档日期</th>
                        <th>操作</th>
                    </tr>
                </thead>
                <tbody>
                    <tr *ngFor="let data of basicSaveDataTable.data">
                        <td nzAlign="center">
                            <label 
                                [nzDisabled]="false"
                                nz-checkbox
                                [(ngModel)]="data.checked"
                                (nzCheckedChange)="showSaveData.onItemChecked(data, $event)">
                            </label>
                        </td>
                        <td>{{ data.A0134 | date: 'yyyy-MM-dd' }}</td>
                        <td>{{ data.GZ0232_CN }}</td>
                        <td>{{ data.SAVE_TIME }}</td>
                        <td>
                            <a nz-button nzType="link" (click)="showSaveData.delete(data)">删除</a>
                        </td>
                    </tr>
                </tbody>
            </nz-table>
        </div>
    </div>
    <ng-template #saveDataFooter>
        <div>
            <button nz-button nzType="primary" (click)="showSaveData.save()">选择人员</button>
        </div>
    </ng-template>
</nz-drawer>
