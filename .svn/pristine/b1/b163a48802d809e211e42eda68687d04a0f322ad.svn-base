import { Component, OnInit } from '@angular/core';
import { ClientService } from 'app/master-page/client/client.service';
import { StartingPlanService } from '../starting-plan/starting-plan.service';

@Component({
    selector: 'gl-subst-person',
    templateUrl: './subst-person.component.html',
    styleUrls: ['./subst-person.component.scss'],
})
export class SubstPersonComponent implements OnInit {
    /**
     * 计划头部操作
     */
    planHandleIfy = {
        year: new Date(),
        yearChange: () => {
            this.planHandleIfy.loadPlanList();
        },

        planId: null,
        list: [],
        loadPlanList: () => {
            this.planHandleIfy.planId = null;
            const params = {
                PLAN02: this.planHandleIfy.year.getFullYear(),
                PLAN05: 0,
            };
            this.planService.selectListByYear(params).subscribe(result => {
                this.planHandleIfy.list = result;
                const [first] = result;
                this.planHandleIfy.planId = first.DATA_3001_OTHER_PLAN_ID;
            });
        },
    };

    constructor(private planService: StartingPlanService, private clientService: ClientService) {}

    ngOnInit(): void {
        this.clientService.buildBreadCrumb([
            {
                type: 'home',
            },
            {
                type: 'text',
                text: '考录人员管理',
            },
        ]);

        this.planHandleIfy.yearChange();
    }
}
